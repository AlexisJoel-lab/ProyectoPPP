USE [master]
GO
--Validación si la DB existe
IF(db_id('DBVENTAS')IS NOT NULL)
--si existe la elimina
 DROP DATABASE DBVENTAS
--Creación de DB
CREATE DATABASE [DBVENTAS]
GO
USE [DBVENTAS] 
GO

/*===============================CREACION DE TABLAS==========================================*/
--Tabla categoría
CREATE TABLE [dbo].[Categoria](
	ID_CATEGORIA integer PRIMARY KEY IDENTITY,
	DESCRIPCION varchar(50) NOT NULL UNIQUE,	
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL
);
GO

--Tabla marca
CREATE TABLE [dbo].[Marca](
	ID_MARCA int PRIMARY KEY IDENTITY,
	DESCRIPCION varchar(50) NOT NULL UNIQUE,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL
);
GO
--Tabla artículo
CREATE TABLE [dbo].[Producto](
	ID_PRODUCTO integer PRIMARY KEY IDENTITY,
	FK_ID_CATEGORIA integer NOT NULL,
	FK_ID_MARCA integer NOT NULL,
	CODIGO varchar(50) NOT NULL,
	DESCRIPCION varchar(100) NOT NULL unique,
	PRECIO_UNIT decimal(11,2) NOT NULL,
	STOCK integer NOT NULL,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
	FOREIGN KEY (FK_ID_CATEGORIA) REFERENCES Categoria(ID_CATEGORIA),
	FOREIGN KEY (FK_ID_MARCA) REFERENCES Marca (ID_MARCA)
);
GO
select * from Cliente
--Tabla cliente
CREATE TABLE [dbo].[Cliente](
	ID_CLIENTE integer PRIMARY KEY IDENTITY(1,1),
	CODIGO AS ('CL' + RIGHT('0000' + CONVERT(VARCHAR, ID_CLIENTE),(4))),
    NOMBRE varchar(100) NOT NULL,	
    APE_PATERNO varchar(100) NOT NULL,
	APE_MATERNO varchar(100) NOT NULL,
	DNI varchar(8) NOT NULL,
	GENERO char(1) check(GENERO IN('M','F')) NOT NULL,--M: Masculino	F:Femenina
	TELEFONO varchar(20) NOT NULL,	
    DIRECCION varchar(70) NOT NULL,
	EMAIL varchar(50) NOT NULL,      
	ESTADO char(1) check(Estado IN('E','H')) NOT NULL,--E: Eventual		H:Habitual
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL
);
GO

--Tabla persona
CREATE TABLE [dbo].[Persona](
	ID_PERSONA integer PRIMARY KEY IDENTITY,
    NOMBRE varchar(100) NOT NULL,
    APE_PATERNO varchar(100) NOT NULL,
	APE_MATERNO varchar(100) NOT NULL,
	DNI integer NOT NULL,
	FECHA_NAC date NOT NULL,
	GENERO bit NOT NULL,
	EMAIL varchar(50) NOT NULL,
    DIRECCION varchar(70) NOT NULL,
	DEPARTAMENTO varchar(50) NOT NULL,
	PROVINCIA varchar(70) NOT NULL,
	DISTRITO varchar(70) NOT NULL,
    TELEFONO varchar(20) NOT NULL,    
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL
);
GO
--Tabla rol
CREATE TABLE [dbo].[Rol](
	ID_ROL integer PRIMARY KEY IDENTITY,
    DESCRIPCION varchar(30) NOT NULL,
    ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL
);
GO
--Tabla usuario
CREATE TABLE [dbo].[Usuario](
	ID_USUARIO integer PRIMARY KEY IDENTITY,
    FK_ID_ROL integer NOT NULL,
	FK_ID_PERSONA integer NOT NULL,
    USUARIO varchar(100) NOT NULL,
	CONTRASEÑA varbinary NOT NULL,
    FOTO varbinary(max) NOT NULL,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
	FOREIGN KEY (FK_ID_ROL) REFERENCES Rol (ID_ROL),
	FOREIGN KEY (FK_ID_PERSONA) REFERENCES Persona (ID_PERSONA)
);
GO
--Tabla modulo
CREATE TABLE [dbo].[Modulo](
	ID_MODULO integer PRIMARY KEY IDENTITY,
    DESCRIPCION varchar(100) NOT NULL,
	ICONO varchar(100) NOT NULL,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL
);
GO
--Tabla operacion
CREATE TABLE [dbo].[Operacion](
	ID_OPERACION integer PRIMARY KEY IDENTITY,
	FK_ID_MODULO integer NOT NULL,
    DESCRIPCION varchar(100) NOT NULL,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
	FOREIGN KEY (FK_ID_MODULO) REFERENCES Modulo (ID_MODULO)
);
GO
--Tabla rol_operacion
CREATE TABLE [dbo].[Rol_Operacion](
	ID_ROL_OPERACION integer PRIMARY KEY IDENTITY,
	FK_ID_ROL integer NOT NULL,
    FK_ID_OPERACION integer NOT NULL,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
	FOREIGN KEY (FK_ID_ROL) REFERENCES Rol (ID_ROL),
	FOREIGN KEY (FK_ID_OPERACION) REFERENCES Operacion (ID_OPERACION)
);
GO
--Tabla ingreso
CREATE TABLE [dbo].[Ingreso](
	ID_INGRESO integer PRIMARY KEY IDENTITY,
    FK_ID_PROVEEDOR integer NOT NULL,
    FK_ID_USUARIO integer NOT NULL,
    TIPO_COMPROBANTE varchar(20) NOT NULL,
    SERIE_COMPROBANTE varchar(7) NULL,
    NUM_COMPROBANTE varchar (10) NOT NULL,
    IMPUESTO decimal (4,2) NOT NULL,
    TOTAL_INGRESO decimal (11,2) NOT NULL,
    ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
    FOREIGN KEY (FK_ID_PROVEEDOR) REFERENCES Persona (ID_PERSONA),
    FOREIGN KEY (FK_ID_USUARIO) REFERENCES Usuario (ID_USUARIO)
);
GO
--Tabla detalle_ingreso
CREATE TABLE [dbo].[Detalle_Ingreso](
	ID_DETALLE_INGRESO integer PRIMARY KEY IDENTITY,
    FK_ID_INGRESO integer NOT NULL,
    FK_ID_PRODUCTO integer NOT NULL,
    CANTIDAD integer NOT NULL,
    PRECIO decimal(11,2) NOT NULL,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
    FOREIGN KEY (FK_ID_INGRESO) REFERENCES Ingreso (ID_INGRESO) ON DELETE CASCADE,
    FOREIGN KEY (FK_ID_PRODUCTO) REFERENCES Producto (ID_PRODUCTO)
);
GO
--Tabla venta
CREATE TABLE [dbo].[Venta](
	ID_VENTA integer PRIMARY KEY IDENTITY,
    FK_ID_CLIENTE integer NOT NULL,
    FK_ID_USUARIO integer NOT NULL,
    TIPO_COMPROBANTE varchar(20) NOT NULL,
    SERIE_COMPROBANTE varchar(7) NULL,
    NUM_COMPROBANTE varchar (10) NOT NULL,
    IMPUESTO decimal (4,2) NOT NULL,
    TOTAL decimal (11,2)NOT NULL,
    ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
    FOREIGN KEY (FK_ID_CLIENTE) REFERENCES Persona (ID_PERSONA),
    FOREIGN KEY (FK_ID_USUARIO) REFERENCES Usuario (ID_USUARIO)
);
GO
--Tabla detalle_venta
CREATE TABLE [dbo].[Detalle_Venta](
	ID_DETALLE_VENTA integer PRIMARY KEY IDENTITY,
    FK_ID_VENTA integer NOT NULL,
    FK_ID_PRODUCTO integer NOT NULL,
    CANTIDAD integer NOT NULL,
    PRECIO decimal(11,2) NOT NULL,
    DESCUENTO decimal(11,2) NOT NULL,
	ELIM_LOGICO bit default(1),
	FECHA_INS datetime NULL,
	FECHA_UPD datetime NULL,
	FECHA_DEL datetime NULL,
    FOREIGN KEY (FK_ID_VENTA) REFERENCES Venta (ID_VENTA) ON DELETE CASCADE,
    FOREIGN KEY (FK_ID_PRODUCTO) REFERENCES Producto (ID_PRODUCTO)
);

/*===============================PROCEDIMIENTOS ALMACENADOS==========================================*/
/*CLIENTE===================*/
--MOSTRAR
CREATE PROCEDURE [dbo].[sp_ClienteMostrar]
AS
    SELECT CODIGO, CONCAT(NOMBRE,' ',APE_PATERNO,' ',APE_MATERNO) AS CLIENTE,DNI,GENERO,TELEFONO,DIRECCION,EMAIL,ESTADO
	FROM Cliente
	WHERE ELIM_LOGICO=1
GO

--INSERTAR 
CREATE PROCEDURE [dbo].[sp_ClienteInsertar]
	@NOMBRE varchar(100),	
    @APE_PATERNO varchar(100),
	@APE_MATERNO varchar(100),
	@DNI varchar(8),
	@GENERO char(1),
	@TELEFONO varchar(20),	
    @DIRECCION varchar(70),
	@EMAIL varchar(50),
	@ESTADO char(1)
AS
	INSERT INTO Cliente (NOMBRE,APE_PATERNO,APE_MATERNO,DNI,GENERO,TELEFONO,DIRECCION,EMAIL,ESTADO,FECHA_INS)
	VALUES (@NOMBRE,@APE_PATERNO,@APE_MATERNO,@DNI,@GENERO,@TELEFONO,@DIRECCION,@EMAIL,@ESTADO,GETDATE())
GO

--EDITAR
CREATE PROCEDURE [dbo].[sp_ClienteEditar]
	@NOMBRE varchar(100),	
    @APE_PATERNO varchar(100),
	@APE_MATERNO varchar(100),
	@DNI varchar(8),
	@GENERO char(1),
	@TELEFONO varchar(20),	
    @DIRECCION varchar(70),
	@EMAIL varchar(50),
	@ESTADO char(1),
	@ID_CLIENTE integer
AS
	UPDATE Cliente SET NOMBRE=@NOMBRE, APE_PATERNO=@APE_PATERNO, APE_MATERNO=@APE_MATERNO, DNI=@DNI,GENERO=@GENERO,TELEFONO=@TELEFONO,DIRECCION=@DIRECCION,EMAIL=@EMAIL,ESTADO=@ESTADO,FECHA_UPD=GETDATE()
	WHERE ID_CLIENTE=@ID_CLIENTE
GO
--ELIMINAR
CREATE PROCEDURE [dbo].[sp_ClienteEliminar]
	@ID_CLIENTE int
AS
	UPDATE Cliente SET ELIM_LOGICO=0,FECHA_DEL=GETDATE() 
	WHERE ID_CLIENTE=@ID_CLIENTE
GO

/*CATEGORIA===================*/
--MOSTRAR
CREATE PROCEDURE [dbo].[Mostrar_Categoria]
AS
	SELECT ID_CATEGORIA AS ID, NOM_CATEGORIA AS CATEGORÍA, DESCRIPCION_CATEGORIA AS DESCRIPCION, ESTADO_CATEGORIA AS ESTADO 
	FROM Categoria
GO
--INSERTAR 
CREATE PROCEDURE [dbo].[Insertar_Categoria]
	@NOM_CATEGORIA varchar(50),
	@DESCRIPCION_CATEGORIA varchar(256),
	@ESTADO_CATEGORIA bit default(1)
AS
	INSERT INTO Categoria VALUES (@NOM_CATEGORIA,@DESCRIPCION_CATEGORIA,@ESTADO_CATEGORIA)
GO
--EDITAR
CREATE PROCEDURE [dbo].[Editar_Categoria]
	@NOM_CATEGORIA varchar(50),
	@DESCRIPCION_CATEGORIA varchar(256),
	@ESTADO_CATEGORIA bit default(1),
	@ID_CATEGORIA int
AS
	UPDATE Categoria SET NOM_CATEGORIA=@NOM_CATEGORIA, DESCRIPCION_CATEGORIA=@DESCRIPCION_CATEGORIA, ESTADO_CATEGORIA=@ESTADO_CATEGORIA 
	WHERE ID_CATEGORIA=@ID_CATEGORIA
GO
--ELIMINAR
CREATE PROCEDURE [dbo].[Editar_Categoria]
	@ID_CATEGORIA int
AS
	DELETE FROM Categoria 
	WHERE ID_CATEGORIA=@ID_CATEGORIA
GO
--BUSCAR
CREATE PROCEDURE [dbo].[Buscar_Categoria]
	@ID_CATEGORIA int
AS
	SELECT ID_CATEGORIA AS ID, NOM_CATEGORIA AS CATEGORÍA, DESCRIPCION_CATEGORIA AS DESCRIPCION, ESTADO_CATEGORIA AS ESTADO 
	FROM Categoria
	WHERE ID_CATEGORIA=@ID_CATEGORIA
GO

/*MARCA===================*/
--MOSTRAR
CREATE PROCEDURE [dbo].[Mostrar_Marca]
AS
	SELECT ID_MARCA AS ID, NOM_MARCA AS MARCA, ESTADO_MARCA AS ESTADO
	FROM Marca
GO
--INSERTAR 
CREATE PROCEDURE [dbo].[Insertar_Marca]
	@NOM_MARCA varchar(50),
	@ESTADO_MARCA bit default(1)
AS
	INSERT INTO Marca VALUES (@NOM_MARCA,@ESTADO_MARCA)
GO
--EDITAR
CREATE PROCEDURE [dbo].[Editar_Marca]
	@NOM_MARCA varchar(50),
	@ESTADO_MARCA bit default(1),
	@ID_MARCA int
AS
	UPDATE Marca SET NOM_MARCA=@NOM_MARCA, ESTADO_MARCA=@ESTADO_MARCA
	WHERE ID_MARCA=@ID_MARCA
GO
--ELIMINAR
CREATE PROCEDURE [dbo].[Editar_Marca]
	@ID_MARCA int
AS
	DELETE FROM Marca
	WHERE ID_MARCA=@ID_MARCA
GO
--BUSCAR
CREATE PROCEDURE [dbo].[Buscar_Marca]
	@ID_CATEGORIA int
AS
	SELECT ID_MARCA AS ID, NOM_MARCA AS MARCA, ESTADO_MARCA AS ESTADO FROM Marca
	WHERE ID_MARCA=@ID_MARCA
GO

/*PRODUCTO===================*/
CREATE PROCEDURE [dbo].[Mostrar_Producto]
AS
	SELECT ID_PRODUCTO AS ID, FK_ID_CATEGORIA AS CATEGORÍA, FK_ID_MARCA AS MARCA, CODIGO_PRODUCTO AS CÓDIGO, NOM_PRODUCTO AS NOMBRE, PRECIO_PRODUCTO AS PRECIO, STOCK_PRODUCTO as Stock, DESCRIPCION_PRODUCTO AS DESCRIPCIÓN, ESTADO_PRODUCTO AS ESTADO
	FROM Producto
GO
--INSERTAR 
CREATE PROCEDURE [dbo].[Insertar_Producto]
	@FK_ID_CATEGORIA int,
	@FK_ID_MARCA int,
	@CODIGO_PRODUCTO varchar(50),
	@NOM_PRODUCTO varchar(100),
	@PRECIO_PRODUCTO decimal(11,2),
	@STOCK_PRODUCTO integer NOT NULL,
	@DESCRIPCION_PRODUCTO varchar(256),
	@ESTADO_PRODUCTO bit default(1),
AS 
	INSERT INTO Producto
	Values (@FK_ID_CATEGORIA,@FK_ID_MARCA,@CODIGO_PRODUCTO,@NOM_PRODUCTO,@PRECIO_PRODUCTO,@STOCK_PRODUCTO,@DESCRIPCION_PRODUCTO,@ESTADO_PRODUCTO)
GO
--EDITAR
CREATE PROCEDURE [dbo].[Editar_Producto]
	@FK_ID_CATEGORIA int,
	@FK_ID_MARCA int,
	@CODIGO_PRODUCTO varchar(50),
	@NOM_PRODUCTO varchar(100),
	@PRECIO_PRODUCTO decimal(11,2),
	@STOCK_PRODUCTO int,
	@DESCRIPCION_PRODUCTO varchar(256),
	@ESTADO_PRODUCTO bit default(1),
	@ID_PRODUCTO int
AS
	UPDATE Producto SET FK_ID_CATEGORIA=@FK_ID_CATEGORIA, FK_ID_MARCA=@FK_ID_MARCA, CODIGO_PRODUCTO=@CODIGO_PRODUCTO, NOM_PRODUCTO=@NOM_PRODUCTO, PRECIO_PRODUCTO =@PRECIO_PRODUCTO, STOCK_PRODUCTO=@STOCK_PRODUCTO, DESCRIPCION_PRODUCTO = @DESCRIPCION_PRODUCTO, ESTADO_PRODUCTO=@ESTADO_PRODUCTO
	WHERE ID_PRODUCTO=@ID_PRODUCTO
GO
--ELIMINAR
CREATE PROCEDURE [dbo].[Eliminar_Producto]
	@ID_PRODUCTO int
As
	DELETE FROM producto
	WHERE ID_PRODUCTO=@ID_PRODUCTO
GO
--BUSCAR
CREATE PROCEDURE [dbo].[Buscar_Producto]
	@ID_PRODUCTO int
AS
SELECT ID_PRODUCTO AS ID, FK_ID_CATEGORIA AS CATEGORÍA, FK_ID_MARCA AS MARCA, CODIGO_PRODUCTO AS CÓDIGO, NOM_PRODUCTO AS NOMBRE, PRECIO_PRODUCTO AS PRECIO, STOCK_PRODUCTO as Stock, DESCRIPCION_PRODUCTO AS DESCRIPCIÓN, ESTADO_PRODUCTO AS ESTADO
	FROM Producto
	WHERE ID_PRODUCTO=@ID_PRODUCTO
GO

/*PERSONA==================*/
CREATE PROCEDURE [dbo].[Mostrar_Persona]
AS
	SELECT ID_PERSONA AS ID, TIPO_PERSONA AS TIPO, NOM_PERSONA AS NOMBRE, TIPO_DOCUMENTO_PERSONA AS DOCUMENTO, NUM_DOCUMENTO_PERSONA AS NÚMERO, DIRECCION_PERSONA AS DIRECCION, TELEFONO_PERSONA AS TELEFONO, EMAIL_PERSONA AS EMAIL, ESTADO_PERSONA AS ESTADO
	FROM Persona
GO
--INSERTAR 
CREATE PROCEDURE [dbo].[Insertar_Persona]
	@TIPO_PERSONA varchar(20),
	@NOM_PERSONA varchar(100),
	@TIPO_DOCUMENTO_PERSONA varchar(20),
	@NUM_DOCUMENTO_PERSONA varchar(20),
	@DIRECCION_PERSONA varchar(70),
	@TELEFONO_PERSONA varchar(20),
	@EMAIL_PERSONA varchar(50),
	@ESTADO_PERSONA bit default(1)
AS
	INSERT INTO Persona VALUES (@TIPO_PERSONA,@NOM_PERSONA,@TIPO_DOCUMENTO_PERSONA,@NUM_DOCUMENTO_PERSONA,@DIRECCION_PERSONA,@TELEFONO_PERSONA,@EMAIL_PERSONA,@ESTADO_PERSONA)
GO
--EDITAR
CREATE PROCEDURE [dbo].[Editar_Persona]
	@TIPO_PERSONA varchar(20),
	@NOM_PERSONA varchar(100),
	@TIPO_DOCUMENTO_PERSONA varchar(20),
	@NUM_DOCUMENTO_PERSONA varchar(20),
	@DIRECCION_PERSONA varchar(70),
	@TELEFONO_PERSONA varchar(20),
	@EMAIL_PERSONA varchar(50),
	@ESTADO_PERSONA bit default(1),
	@ID_PERSONA int
AS
	UPDATE Persona SET TIPO_PERSONA=@TIPO_PERSONA, NOM_PERSONA=@NOM_PERSONA, TIPO_DOCUMENTO_PERSONA=@TIPO_DOCUMENTO_PERSONA, NUM_DOCUMENTO_PERSONA=@NUM_DOCUMENTO_PERSONA, DIRECCION_PERSONA=@DIRECCION_PERSONA, TELEFONO_PERSONA=@TELEFONO_PERSONA, EMAIL_PERSONA=@EMAIL_PERSONA, ESTADO_PERSONA=@ESTADO_PERSONA
	WHERE ID_PERSONA=@ID_PERSONA
GO
--ELIMINAR
CREATE PROCEDURE [dbo].[Eliminar_Persona]
	@ID_PERSONA int
AS
	DELETE FROM Persona 
	WHERE ID_PERSONA=@ID_PERSONA
GO
--BUSCAR
CREATE PROCEDURE [dbo].[Buscar_Persona]
	@ID_PERSONA int
AS
	SELECT ID_PERSONA AS ID, TIPO_PERSONA AS TIPO, NOM_PERSONA AS NOMBRE, TIPO_DOCUMENTO_PERSONA AS DOCUMENTO, NUM_DOCUMENTO_PERSONA AS NÚMERO, DIRECCION_PERSONA AS DIRECCION, TELEFONO_PERSONA AS TELEFONO, EMAIL_PERSONA AS EMAIL, ESTADO_PERSONA AS ESTADO
	FROM Persona
	WHERE ID_PERSONA=@ID_PERSONA
GO

/*ROL==================*/
CREATE PROCEDURE [dbo].[Mostrar_Rol]
AS
	SELECT ID_ROL AS ID, NOM_ROL AS ROL, DESCRIPCION_ROL AS DESCRIPCIÓN, ESTADO_PERSONA AS ESTADO
	FROM Rol
GO
--INSERTAR 
CREATE PROCEDURE [dbo].[Insertar_Rol]
	@NOM_ROL varchar(30),
	@DESCRIPCION_ROL varchar(100),
	@ESTADO_ROL bit default(1)
AS
	INSERT INTO Rol VALUES (@NOM_ROL,@DESCRIPCION_ROL,@ESTADO_ROL)
GO
--EDITAR
CREATE PROCEDURE [dbo].[Editar_Rol]
	@NOM_ROL varchar(30),
	@DESCRIPCION_ROL varchar(100),
	@ESTADO_ROL bit default(1),
	@ID_ROL int
AS
	UPDATE Rol SET NOM_ROL=@NOM_ROL,DESCRIPCION_ROL=@DESCRIPCION_ROL,ESTADO_ROL=@ESTADO_ROL
	WHERE ID_ROL=@ID_ROL
GO
--ELIMINAR
CREATE PROCEDURE [dbo].[Eliminar_Rol]
	@ID_ROL int
AS
	DELETE FROM Rol 
	WHERE ID_ROL=@ID_ROL
GO
--BUSCAR
CREATE PROCEDURE [dbo].[Buscar_Rol]
	@ID_ROL int
AS
	SELECT ID_ROL AS ID, NOM_ROL AS ROL, DESCRIPCION_ROL AS DESCRIPCIÓN, ESTADO_PERSONA AS ESTADO
	FROM Rol
	WHERE ID_ROL=@ID_ROL
GO

/*USUARIO==================*/
CREATE PROCEDURE [dbo].[Mostrar_Usuario]
AS
	SELECT ID_USUARIO AS ID, FK_ID_ROL AS ROL, USUARIO, CONTRASEÑA, TIPO_DOCUMENTO_USUARIO AS DOCUMENTO,NUM_DOCUMENTO_USUARIO AS [NÚMERO DE DOCUMENTO], DIRECCION_USUARIO AS DIRECCIÓN,TELEFONO_USUARIO AS TELÉFONO, EMAIL_USUARIO AS EMAIL, ESTADO_USUARIO AS ESTADO
	FROM Usuario
GO
--INSERTAR 
CREATE PROCEDURE [dbo].[Insertar_Usuario]
	@FK_ID_ROL int,
	@USUARIO varchar(100),
	@CONTRASEÑA varbinary,
	@TIPO_DOCUMENTO_USUARIO varchar(20),
	@NUM_DOCUMENTO_USUARIO varchar(20),
	@DIRECCION_USUARIO varchar(70),
	@TELEFONO_USUARIO varchar(20),
	@EMAIL_USUARIO varchar(50),
	@ESTADO_USUARIO bit default(1)
AS
	INSERT INTO Usuario VALUES (@FK_ID_ROL,@USUARIO,@CONTRASEÑA,@TIPO_DOCUMENTO_USUARIO,@NUM_DOCUMENTO_USUARIO,@DIRECCION_USUARIO,@TELEFONO_USUARIO,@EMAIL_USUARIO,@ESTADO_USUARIO)
GO
--EDITAR
CREATE PROCEDURE [dbo].[Editar_Usuario]
	@FK_ID_ROL int,
	@USUARIO varchar(100),
	@CONTRASEÑA varbinary,
	@TIPO_DOCUMENTO_USUARIO varchar(20),
	@NUM_DOCUMENTO_USUARIO varchar(20),
	@DIRECCION_USUARIO varchar(70),
	@TELEFONO_USUARIO varchar(20),
	@EMAIL_USUARIO varchar(50),
	@ESTADO_USUARIO bit default(1)
	@ID_USUARIO int
AS
	UPDATE Usuario SET FK_ID_ROL=@FK_ID_ROL,USUARIO=@USUARIO,CONTRASEÑA=@CONTRASEÑA,TIPO_DOCUMENTO_USUARIO=@TIPO_DOCUMENTO_USUARIO,NUM_DOCUMENTO_USUARIO=@NUM_DOCUMENTO_USUARIO
	WHERE ID_USUARIO=@ID_USUARIO
GO
--ELIMINAR
CREATE PROCEDURE [dbo].[Eliminar_Usuario]
	@ID_ROL int
AS
	DELETE FROM Rol 
	WHERE ID_ROL=@ID_ROL
GO
--BUSCAR
CREATE PROCEDURE [dbo].[Buscar_Usuario]
	@ID_ROL int
AS
	SELECT ID_ROL AS ID, NOM_ROL AS ROL, DESCRIPCION_ROL AS DESCRIPCIÓN, ESTADO_PERSONA AS ESTADO
	FROM Rol
	WHERE ID_ROL=@ID_ROL
GO
